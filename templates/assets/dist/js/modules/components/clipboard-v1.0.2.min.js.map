{"version":3,"file":"clipboard-v1.0.2.min.js","sources":["../../../../../../src/js/modules/components/clipboard.js"],"sourcesContent":["/**\r\n * Clipboard functions\r\n *\r\n * Dependencies:\r\n *   - popper.js (https://github.com/popperjs/popper-core)\r\n *   - clipboard.js (https://github.com/zenorocha/clipboard.js)\r\n */\r\n\r\nconst clipboardSelector = '.code-header>button';\r\nconst ICON_SUCCESS = 'fas fa-check';\r\nconst ATTR_TIMEOUT = 'timeout';\r\nconst ATTR_TITLE_SUCCEED = 'data-title-succeed';\r\nconst ATTR_TITLE_ORIGIN = 'data-bs-original-title';\r\nconst TIMEOUT = 2000; // in milliseconds\r\n\r\nfunction isLocked(node) {\r\n  if ($(node)[0].hasAttribute(ATTR_TIMEOUT)) {\r\n    let timeout = $(node).attr(ATTR_TIMEOUT);\r\n    if (Number(timeout) > Date.now()) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction lock(node) {\r\n  $(node).attr(ATTR_TIMEOUT, Date.now() + TIMEOUT);\r\n}\r\n\r\nfunction unlock(node) {\r\n  $(node).removeAttr(ATTR_TIMEOUT);\r\n}\r\n\r\nfunction getIcon(btn) {\r\n  let iconNode = $(btn).children();\r\n  return iconNode.attr('class');\r\n}\r\n\r\nconst ICON_DEFAULT = getIcon(clipboardSelector);\r\n\r\nfunction showTooltip(btn) {\r\n  const succeedTitle = $(btn).attr(ATTR_TITLE_SUCCEED);\r\n  $(btn).attr(ATTR_TITLE_ORIGIN, succeedTitle).tooltip('show');\r\n}\r\n\r\nfunction hideTooltip(btn) {\r\n  $(btn).tooltip('hide').removeAttr(ATTR_TITLE_ORIGIN);\r\n}\r\n\r\nfunction setSuccessIcon(btn) {\r\n  let btnNode = $(btn);\r\n  let iconNode = btnNode.children();\r\n  iconNode.attr('class', ICON_SUCCESS);\r\n}\r\n\r\nfunction resumeIcon(btn) {\r\n  let btnNode = $(btn);\r\n  let iconNode = btnNode.children();\r\n  iconNode.attr('class', ICON_DEFAULT);\r\n}\r\n\r\nexport function initClipboard() {\r\n  // Initial the clipboard.js object\r\n  if ($(clipboardSelector).length) {\r\n    const clipboard = new ClipboardJS(clipboardSelector, {\r\n      target(trigger) {\r\n        let codeBlock = trigger.parentNode.nextElementSibling;\r\n        return codeBlock.querySelector('code .rouge-code');\r\n      }\r\n    });\r\n\r\n    const clipboardList = document.querySelectorAll(clipboardSelector);\r\n    [...clipboardList].map(\r\n      (elem) =>\r\n        new bootstrap.Tooltip(elem, {\r\n          placement: 'left'\r\n        })\r\n    );\r\n\r\n    clipboard.on('success', (e) => {\r\n      e.clearSelection();\r\n\r\n      const trigger = e.trigger;\r\n      if (isLocked(trigger)) {\r\n        return;\r\n      }\r\n\r\n      setSuccessIcon(trigger);\r\n      showTooltip(trigger);\r\n      lock(trigger);\r\n\r\n      setTimeout(() => {\r\n        hideTooltip(trigger);\r\n        resumeIcon(trigger);\r\n        unlock(trigger);\r\n      }, TIMEOUT);\r\n    });\r\n  }\r\n\r\n  /* --- Post link sharing --- */\r\n\r\n  $('#copy-link').on('click', (e) => {\r\n    let target = $(e.target);\r\n\r\n    if (isLocked(target)) {\r\n      return;\r\n    }\r\n\r\n    // Copy URL to clipboard\r\n    navigator.clipboard.writeText(window.location.href).then(() => {\r\n      const defaultTitle = target.attr(ATTR_TITLE_ORIGIN);\r\n      const succeedTitle = target.attr(ATTR_TITLE_SUCCEED);\r\n      // Switch tooltip title\r\n      target.attr(ATTR_TITLE_ORIGIN, succeedTitle).tooltip('show');\r\n      lock(target);\r\n\r\n      setTimeout(() => {\r\n        target.attr(ATTR_TITLE_ORIGIN, defaultTitle);\r\n        unlock(target);\r\n      }, TIMEOUT);\r\n    });\r\n  });\r\n}\r\n"],"names":["clipboardSelector","ICON_SUCCESS","ATTR_TIMEOUT","ATTR_TITLE_SUCCEED","ATTR_TITLE_ORIGIN","isLocked","node","timeout","lock","unlock","getIcon","btn","ICON_DEFAULT","showTooltip","succeedTitle","hideTooltip","setSuccessIcon","resumeIcon","initClipboard","clipboard","trigger","elem","e","target","defaultTitle"],"mappings":"AAQA,MAAMA,EAAoB,sBACpBC,EAAe,eACfC,EAAe,UACfC,EAAqB,qBACrBC,EAAoB,yBAG1B,SAASC,EAASC,EAAM,CACtB,GAAI,EAAEA,CAAI,EAAE,CAAC,EAAE,aAAaJ,CAAY,EAAG,CACzC,IAAIK,EAAU,EAAED,CAAI,EAAE,KAAKJ,CAAY,EACvC,GAAI,OAAOK,CAAO,EAAI,KAAK,IAAG,EAC5B,MAAO,EAEV,CACD,MAAO,EACT,CAEA,SAASC,EAAKF,EAAM,CAClB,EAAEA,CAAI,EAAE,KAAKJ,EAAc,KAAK,IAAG,EAAK,GAAO,CACjD,CAEA,SAASO,EAAOH,EAAM,CACpB,EAAEA,CAAI,EAAE,WAAWJ,CAAY,CACjC,CAEA,SAASQ,EAAQC,EAAK,CAEpB,OADe,EAAEA,CAAG,EAAE,SAAQ,EACd,KAAK,OAAO,CAC9B,CAEA,MAAMC,EAAeF,EAAQV,CAAiB,EAE9C,SAASa,EAAYF,EAAK,CACxB,MAAMG,EAAe,EAAEH,CAAG,EAAE,KAAKR,CAAkB,EACnD,EAAEQ,CAAG,EAAE,KAAKP,EAAmBU,CAAY,EAAE,QAAQ,MAAM,CAC7D,CAEA,SAASC,EAAYJ,EAAK,CACxB,EAAEA,CAAG,EAAE,QAAQ,MAAM,EAAE,WAAWP,CAAiB,CACrD,CAEA,SAASY,EAAeL,EAAK,CACb,EAAEA,CAAG,EACI,WACd,KAAK,QAASV,CAAY,CACrC,CAEA,SAASgB,EAAWN,EAAK,CACT,EAAEA,CAAG,EACI,WACd,KAAK,QAASC,CAAY,CACrC,CAEO,SAASM,GAAgB,CAE9B,GAAI,EAAElB,CAAiB,EAAE,OAAQ,CAC/B,MAAMmB,EAAY,IAAI,YAAYnB,EAAmB,CACnD,OAAOoB,EAAS,CAEd,OADgBA,EAAQ,WAAW,mBAClB,cAAc,kBAAkB,CAClD,CACP,CAAK,EAGD,CAAC,GADqB,SAAS,iBAAiBpB,CAAiB,CAChD,EAAE,IAChBqB,GACC,IAAI,UAAU,QAAQA,EAAM,CAC1B,UAAW,MACrB,CAAS,CACT,EAEIF,EAAU,GAAG,UAAYG,GAAM,CAC7BA,EAAE,eAAc,EAEhB,MAAMF,EAAUE,EAAE,QACdjB,EAASe,CAAO,IAIpBJ,EAAeI,CAAO,EACtBP,EAAYO,CAAO,EACnBZ,EAAKY,CAAO,EAEZ,WAAW,IAAM,CACfL,EAAYK,CAAO,EACnBH,EAAWG,CAAO,EAClBX,EAAOW,CAAO,CACf,EAAE,GAAO,EAChB,CAAK,CACF,CAID,EAAE,YAAY,EAAE,GAAG,QAAUE,GAAM,CACjC,IAAIC,EAAS,EAAED,EAAE,MAAM,EAEnBjB,EAASkB,CAAM,GAKnB,UAAU,UAAU,UAAU,OAAO,SAAS,IAAI,EAAE,KAAK,IAAM,CAC7D,MAAMC,EAAeD,EAAO,KAAKnB,CAAiB,EAC5CU,EAAeS,EAAO,KAAKpB,CAAkB,EAEnDoB,EAAO,KAAKnB,EAAmBU,CAAY,EAAE,QAAQ,MAAM,EAC3DN,EAAKe,CAAM,EAEX,WAAW,IAAM,CACfA,EAAO,KAAKnB,EAAmBoB,CAAY,EAC3Cf,EAAOc,CAAM,CACd,EAAE,GAAO,CAChB,CAAK,CACL,CAAG,CACH"}