{"version":3,"file":"app-v1.0.2.min.js","sources":["../../../../../src/js/pwa/app.js"],"sourcesContent":["const $notification = $('#notification');\nconst $btnRefresh = $('#notification .toast-body>button');\n\nif ('serviceWorker' in navigator) {\n    /* Registering Service Worker */\n    navigator.serviceWorker.register('{{ \"/sw.js\" | relative_url }}')\n        .then(registration => {\n\n            /* in case the user ignores the notification */\n            if (registration.waiting) {\n                $notification.toast('show');\n            }\n\n            registration.addEventListener('updatefound', () => {\n                registration.installing.addEventListener('statechange', () => {\n                    if (registration.waiting) {\n                        if (navigator.serviceWorker.controller) {\n                            $notification.toast('show');\n                        }\n                    }\n                });\n            });\n\n            $btnRefresh.click(() => {\n                if (registration.waiting) {\n                    registration.waiting.postMessage('SKIP_WAITING');\n                }\n                $notification.toast('hide');\n            });\n        });\n\n    let refreshing = false;\n\n    /* Detect controller change and refresh all the opened tabs */\n    navigator.serviceWorker.addEventListener('controllerchange', () => {\n        if (!refreshing) {\n            window.location.reload();\n            refreshing = true;\n        }\n    });\n}\n\n"],"names":["$notification","$btnRefresh","registration","refreshing"],"mappings":"AAAA,MAAMA,EAAgB,EAAE,eAAe,EACjCC,EAAc,EAAE,kCAAkC,EAExD,GAAI,kBAAmB,UAAW,CAE9B,UAAU,cAAc,SAAS,+BAA+B,EAC3D,KAAKC,GAAgB,CAGdA,EAAa,SACbF,EAAc,MAAM,MAAM,EAG9BE,EAAa,iBAAiB,cAAe,IAAM,CAC/CA,EAAa,WAAW,iBAAiB,cAAe,IAAM,CACtDA,EAAa,SACT,UAAU,cAAc,YACxBF,EAAc,MAAM,MAAM,CAGtD,CAAiB,CACjB,CAAa,EAEDC,EAAY,MAAM,IAAM,CAChBC,EAAa,SACbA,EAAa,QAAQ,YAAY,cAAc,EAEnDF,EAAc,MAAM,MAAM,CAC1C,CAAa,CACb,CAAS,EAEL,IAAIG,EAAa,GAGjB,UAAU,cAAc,iBAAiB,mBAAoB,IAAM,CAC1DA,IACD,OAAO,SAAS,SAChBA,EAAa,GAEzB,CAAK,CACL"}